This was copied and adapted from code in an answer at:
https://stackoverflow.com/questions/36762248/why-is-stdqueue-not-thread-safe
